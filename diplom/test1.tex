
\documentclass[pdf,10pt,unicode]{beamer}
%\usepackage{pscyr}
\usepackage{cmap}
\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage{graphicx}
\graphicspath{{images/}}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage[english,russian]{babel}
%\usepackage{mvkrep}


\usetheme{Warsaw}
%\usetheme[numbers, totalnumbers, compress]{Statmod}

\renewcommand{\refname}{Список литературы}
\renewcommand{\contentsname}{Оглавление}
\renewcommand{\figurename}{Рисунок}

\newcommand{\cmnt}[1]{{\color{blue}\bf #1}}
\newcommand{\bigcmnt}[1]{ {  \cmnt{ Комментарий.}} #1 { \cmnt{Конец комментария.}} }
\newcommand{\Ell}[1]{\mathcal{E}(#1)}
\newcommand{\EE}{\mathcal{E}}
\newcommand{\ts}[1]{\left\langle #1 \right\rangle}
\newcommand{\intd}[2]{ \int\limits_{#1}^{#2} }
\newcommand{\supfn}[2]{ \rho\left( #1 \mid #2 \right)}
\newcommand{\supfnl}[1]{ \supfn{\ell}{#1}}
\newcommand{\conv}{\mathrm{conv}}
\newcommand{\norma}[1]{\mid #1 \mid}
\newcommand{\rdim}[1]{\ensuremath{\mathbb{R}^{#1}}}
\newcommand{\XX}{ \mathcal{X} }
\newcommand{\PP}{ \mathcal{P} }
\newcommand{\CaH}{\mathcal{C}^\alpha_H}
\newcommand{\TTa}{T^\alpha}
\newtheorem{define}{Определение}
\newtheorem{propose}{Утверждение}




\newcommand{\labimage}[4]{\begin{figure}[h]%
\centerline{\includegraphics[width=#2cm]{#1}}\caption{#3}\label{#4}%
\end{figure}}
\newcommand{\image}[3]{\begin{figure}[h]%
\centerline{\includegraphics[width=#2cm]{#1}}\caption{#3}\end{figure}}
\newcommand{\twinimage}[4]{\begin{figure}[h]%
\centerline{\includegraphics[width=#3cm]{#1}\hspace{1cm} %
\includegraphics[width=#3cm]{#2}}\vspace{0.3cm}\caption{#4}\end{figure}}


\begin{document}

\title[Построение множества достижимости]
{{\center {\small Магистерская диссертация на тему:}} {\center Построение множества достижимости для гибридной системы с одним переключением с неопределённостью}}
%\subtitle{\normalsize }  
%\title{Построение множества достижимости для гибридной системы с одним преключением с неопределённостью}  
\author[Системный анализ]{ \\ Выполнил : Селиверстов Д.С.\\ \hfill  Научный руководитель: к.ф.-м.н. Точилин П.А.}

\institute[МГУ]
{
Московский Государственный университет им. М.В. Ломоносова\\
Кафедра системного анализа
}

\date{2010} 

\frame{\titlepage} 


\section{Постановка задачи} 

%%%%%%%%%%%%%%%%%%%%%%%% Постановка задачи  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{

\frametitle{Модель гибридной системы} 
\begin{equation}
\left\{
\begin{aligned}
&\left[
 \begin{aligned}
    &\left\{
		    \begin{aligned}
		        &\dot x^{(1)} = A^{(1)}(t)x^{(1)}+B^{(1)}(t)u^{(1)}(t)+C^{(1)}(t)v^{(1)}(t);\\
		        &x(t_0)\in\mathcal{E}(x_0,X_0)=\mathcal{X}_0;\\
		    \end{aligned}
    \right.\\
    &\left\{
		    \begin{aligned}
		        &\dot x^{(2)} = A^{(2)}(t)x^{(2)}+B^{(2)}(t)u^{(2)}(t)+C^{(2)}(t)v^{(2)}(t);\\
		        &x(\tau)\in\mathcal{X}^{(1)}(\tau,t_0)\cap H;\\
		    \end{aligned}
    \right.
	\end{aligned}
\right.
\\
&H=\{x\in\mathbb R^n\colon \ts{x,c}=\gamma\}\mbox{--- гиперплоскость переключения};\\
&A(t)\in \mathbb{R}^{n\times n},\,B(t)\in \mathbb{R}^{n\times m},\,C(t)\in \mathbb{R}^{n\times k};\;A(t),B(t),C(t) \in  L_1[t_0,t_1];\\
&\tau:\;\ts{x^{(1)}(\tau),c}-\gamma=0,\;\tau\in[t_0,t_1]\\
&u^{(1)}(t)\in\mathcal{E}(p^{(1)}(t),P^{(1)}(t))=\mathcal{P}^{(1)}[t_0,t_1];\\
&v^{(1)}(t)\in\mathcal{E}(w^{(1)}(t),W^{(1)}(t))=\mathcal{V}^{(1)}[t_0,t_1];\\
&u^{(2)}(t)\in\mathcal{E}(p^{(2)}(t),P^{(2)}(t))=\mathcal{P}^{(2)}[t_0,t_1];\\
&v^{(2)}(t)\in\mathcal{E}(w^{(2)}(t),W^{(2)}(t))=\mathcal{V}^{(2)}[t_0,t_1];\\
\end{aligned}
\right.
\label{eq:mainsystem}
\end{equation}


}

%%%%%%%%%%%%%%%%%%%%%%%% трансверсальность %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame} \frametitle{Условие трансверсальности}
При переключении гибридная система должна удовлетворять условию односторонней проницаемости, что равносильно выполнению системы соотношений: 
%\centerline
\begin{minipage}{5.5cm}
%	\begin{block}
	$$%\begin{equation}
	\left\{
	\begin{aligned}
				&\ts{x(\tau),c} - \gamma = 0,\\
				&\ts{\dot x,c} > 0,\\			
	\end{aligned}
	\right.
	$$
	где $c,\gamma$-- параметры гиперплоскости
	$$
	H=\{x\mid\ts{x,c}=\gamma\},
	$$
	$x(t)$--траектория  либо первой из систем, либо второй.
	\vfill
%	\end{block}
\end{minipage}
	\hspace{0.5cm}	\begin{minipage}{4cm}\labimage{Hexample}{4}{}{pic:perehod}\end{minipage}

Тогда любая траектория гибридной системы не может касаться гиперплоскости, но пересекает эту гиперплоскость только один раз.

\end{frame}
 																														
\frame{ \frametitle{Выполнение условия трансверсальности}

\twinimage{transv1}{transv2}{4.5}{Выполнение и невыполнение условий трансверсальности}%
$$
	\left\{
		\begin{aligned}
					&\ts{x(\tau),c} - \gamma = 0,\\
					&\ts{\dot x,c} > 0,\\			
		\end{aligned}
		\right.
$$
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Множество достижимости ( определение )%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\frame{  \frametitle{Множество достижимости}

\begin{define}
Множеством достижимости $\mathcal {X}[t,t_0]$  для задачи \eqref{eq:mainsystem} называется
$$
\mathcal {X}[t]=\big\{x^* \mid\exists u_1(\cdot)\in\mathcal{P}^{(1)},\exists u_2(\cdot)\in\mathcal{P}^{(2)}:
$$
$$
\forall v_1(\cdot)\in\mathcal{V}^{(1)},\forall v_2(\cdot)\in\mathcal{V}^{(2)}: \exists x_0\in \XX_0:
$$
$$
x(t,t_0,x_0)=x^*, x(t,t_0,x_0)\cap H \neq \emptyset \big\}
$$
\end{define}
Множество достижимости ищется в классе программных управлений $u(t)$, не зависящих от фазовых координат $x$ системы, что не позволяет корректировать управление в зависимости от момента переключения $\tau_H$ и помехи.

}



\section{Поиск решения}
%%%%%%%%%%%%%%%%%%%%%%%%%%%% Множество достижимости ( как ищем ) %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% я описываю сначала решение на языке множеств, потому что предполагаю, что так понятнее. 
% 
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%% Здесь мы объясняем как оно устроено  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Применение методов многозначного анализа}

\frame{   \frametitle{Множество достижимости до переключения}

Множество гарантированно достижимых точек
$$
\XX_1[t]=\left(\XX_0[t]\dot-V_1[t]\right)+\PP_1[t],\quad \mbox{где}
$$
$$
V_1[t]=\intd{t_0}{t}G(t,s)\Ell{w_1(s),W_1(s)}ds,\:\mbox{--множество неопределенности, помех.}
$$
$$
\PP_1[t]=\intd{t_0}{t}G(t,s)\Ell{p_1(s),P_1(t)}ds,\:\mbox{--множество управлений.}
$$
$$
\mathcal{C}^\alpha[t]=\mathcal{X}_0\dot-V_1[t]+p^\alpha,\quad p^\alpha(t)\in \mathcal{P}_1[t],
$$
-- множество гарантированного покрытия при фиксированном управлении $p^\alpha(t)$
%\mathcal{C}^\alpha_H[\tau]= \left\{ (\mathcal{C}[\tau]+p^\alpha) \cap H \right\}
Эллипсоидальная оценка множества гарантированного покрытия
$$
\cup\EE^i_- \subset \mathcal{C}^\alpha[t] \subset \cap\EE^i_+
$$
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\frame{ \frametitle{Множество достижимости при переключении }

\begin{minipage}{5cm}
\image{ellips_ints_H2D}{5}{Пересечение $\EE_H=\EE\cap H$}
\end{minipage}
\hspace{0.3cm}
\parbox{4cm}{Вычисление пересечения $$ \mathcal{C}^\alpha_H[\tau]=\mathcal{C}^\alpha[\tau]\cap H$$ 
$$\Leftrightarrow\{\EE^i\cap H\} \rightarrow \{\EE^i_H\}$$

Приходим к задаче
$$
\left\{
		    \begin{aligned}
		        &\dot x^{(2)} = A^{(2)}x^{(2)}+B^{(2)}u^{(2)}+C^{(2)}v^{(2)};\\
		        &x(\tau)\in\mathcal{C}^\alpha_H[\tau],\tau\in \TTa,
		    \end{aligned}
 \right.
$$}
где
$$
\TTa=\left\{\tau\mid \mathcal{C}^\alpha[\tau]\cap H\neq\emptyset \right\}\overset{\underset{\mbox{(трансверсальность)}}{}}{=}[\tau^\alpha_1,\tau^\alpha_2]
$$


}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\frame{ \frametitle{Множество достижимости после переключения }
Множество достижимости ищем в соответствии
$$
\XX^\alpha_2[t]=\{ x^*\mid \exists u_2:\forall v_2: \exists \tau\in\TTa, x_0\in\CaH[\tau]: x(t,\tau,x_0)=x^* \}
$$
Целесообразно перейти к виду 
\begin{equation}
\XX^\alpha_2[t]=\{ x^*\mid \exists u_2:\forall v_2: \exists \tau\in\TTa: x(\tau,t,x^*)\cap H\in \CaH\}
\label{eq:opr2}
\end{equation}

$x(t)$ -- сумма управляемой и неуправляемой составляющей 
$$
x(\tau,t,x^*) = \xi(\tau)+v_2(\tau),\quad v_2(\tau)\in V_2[\tau]
$$
$$
V_2[\tau]=\intd{t}{\tau}G_2(\tau,s)\Ell{w_2(s),W_2(s)}ds
$$

Найдем все такие $\xi(\tau)\in Z[\tau]$ чтобы выполнялось \eqref{eq:opr2}
$$
Z[\tau]=\{\xi(\tau)\mid (\xi(\tau)+V_2[\tau])\cap H \subset \CaH[\tau]\}
$$ 

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{ \frametitle{Множество фазовых ограничений}
$$
Z[\tau]=\{\xi(\tau)\mid (\xi(\tau)+V_2[\tau])\cap H \subset \CaH[\tau]\},
$$ 
\image{bset_xi_H}{5}{Фазовые ограничения $Z[\tau]$~--синий, помеха $V_2[\tau]$~--красный, множество $\CaH[\tau]$~--зеленый.\\
{\centerline{  вычисляется как $Z[\tau]=\overline{ H\setminus \CaH[\tau] + V_2[\tau]}$}}}

}


\frame{ \frametitle{Решение задачи с фазовыми ограничениями}

Задача на поиск множества достижимости при фазовых ограничениях, но уже без помехи.
$$
\mathcal{X}^\alpha_2[t_1]=\big\{x(t_1) \mid  \exists u_2: G(\tau,t_1)x(t_1)+\intd{t_1}{\tau}G(\tau,t_1)u_2(s)ds \in Z(\tau), \forall \tau\in \TTa\big\}
$$

Функция цены c учетом ограничений (задача огибания$\xi[\tau]\notin\overline{Z[\tau]}$ )
$$
V(t,x)=\max_{\lambda(\cdot)\in L^0}\max_{\ell,\Lambda(\cdot)}\big\{p^T(t_1)x_1-\intd{t_0}{t_1}\supfn{p(s)}{\PP(s)}ds-\supfn{s(t_0)}{\XX_0}+1\big\},
$$
Тогда множество достижимости находится как множество уровня
$$\XX^\alpha_2[t,t_0]=\{x\mid V(t,x)\le 0\}$$
}

%где $L_0[t]$~--множество функций, таких что
%$\tau:x(\tau)\notin\EE^i_{\pm}(0,Y(\tau)) \Leftrightarrow \exists \lambda^0\in L_0[\tau]: \ts{\lambda^0,x(\tau)}\ge 1$, $Y(t)$~--матрица эллипсоидальной оценки множества $V_2[\tau].$

\subsection{Результаты}

\frame{\frametitle{Пример $\rdim{1}$}
Рассматривается модель гибридной системы
\begin{equation}
\label{eq:prim1a}
\left\{
\begin{aligned}
	&\left[
		\begin{aligned}
				&\dot x_1=u_1+v_1; \\
				&\dot x_2=u_2+v_2;
		\end{aligned}
	 \right.\\
	&u_1(t)\in[0.4\cos(\pi\cdot t),1.5+0.6\sin(\pi\cdot t)]=\PP^{(1)};\\
	&v_1(t)\in[0,0.2+0.1\sin(\pi\cdot t)]=\mathcal{V}^{(1)};\\
	&u_2(t)\in[0.3+\sin^2(\pi\cdot t),0.5\cos^2(\pi\cdot t)]=\PP^{(2)};\\
	&v_2(t)\in[-0.1\sqrt{t},0.1\sqrt{t}]=\mathcal{V}^{(2)};\\
	&\mathcal{X}_0=[-2,-1],\;x(t)\in\rdim{1}\\
	&t\in[0,4];\\
	&H=\{x=0\}.
\end{aligned}
\right.
\end{equation}

}

\frame{ \frametitle{Вложение множества помехи $V_2[\tau]$ во множесто $\CaH[\tau]$}

\image{x2simple}{7}{ Множество достижимости $\XX^\alpha[t_1], \alpha=\{1,2\}$ }

}

\frame{ \frametitle{ Множество достижимости для большого набора $\alpha$.}
\image{notsimplex2}{7}{ Множество достижимости $\XX^\alpha[t_1], \alpha=\{1\ldots 30\}$ }

}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{ \frametitle{Функция цены для всей гибридной системы}

$$
 V(t,x)=\min_{\phi(\cdot)} \max_{\ell(\cdot)}\max_{\mu(\cdot)} \bigg\{  S^T(t_0,t)x - \intd{t_0}{t} \rho(S_1(s,t)\mid B_1(s)\mathcal{P}_1(s))\,ds - 
$$
$$
   - \intd{t_0}{t} \rho(S(t_0,s)\mid B_2(s)\mathcal{P}_2(s))\,ds - \mbox{conv}\big\{ K(\ell,\mu,\mathcal{X}_0) -
$$ 
$$
 -\intd{t_0}{t}\rho(-S_1(s,t)\mid C_1(s)\mathcal{V}_1(s))\,ds-\intd{t_0}{t}\rho(-S(t_0,s)\mid C_2(s)\mathcal{V}_2(s)) \,ds   \big\}\bigg\}
$$

}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%
%\section{Примеры}
%
%
%\subsection{Пример 1, $\rdim{1}$}
%\frame{ \frametitle{Пример 1, постановка}
%
%\begin{equation}
%\label{eq:prim1}
%\left\{
%\begin{aligned}
%	&\left[
%		\begin{aligned}
%				&\dot x=2u+v;\\
%				&\dot x=u;\\
%		\end{aligned}
%	 \right.\\
%	&u\in[0,1];\\
%	&v\in[0,1];\\
%	&\mathcal{X}_0=\{x\in[-2,-1]\};\\
%	&t\in[0,4];\\
%	&H=\{x=0\}.
%\end{aligned}
%\right.
%\end{equation}
%
%}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Иллюстрация результатов %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%слайд
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%
%\subsection{Пример 2, $\rdim{1}$}
%
%\frame{ \frametitle{Пример 2, постановка}
%
%
%\begin{equation}
%\label{eq:prim2}
%\left\{
%\begin{aligned}
%&\left[
%	\begin{aligned}
%			&\dot x=u;\\
%			&\dot x=2u+v;\\
%	\end{aligned}
%\right.\\
%&u\in[0,1];\\
%&v\in[0,1];\\
%&\mathcal{X}_0=\{x\in[-2,-1]\};\\
%&t\in[0,4];\\
%&H=\{x=0\}.
%\end{aligned}
%\right.
%\end{equation}
%
%}
%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Иллюстрация результатов %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%слайд
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{В заключение }


\frame{ \frametitle{Выводы}

%взято из введениия
В данной работе рассмотрены два подхода к решению задачи достижимости: 
\begin{itemize}
\item C помощью методов многозначного анализа.
\item При помощи функций цены и методов выпуклого анализа
\end{itemize} 

В первом случае множества достижимости построены в явном виде, за счет применения операций с выпуклыми компактами, а во втором методе указанные множества представлены в виде множеств уровней (множеств Лебега) для специальных функций.
%Рассмотрены два примера в одномерном фазовом пространстве.

Решение данной задачи можно рассматривать как первый шаг к построению теории достижимости при неопределенности для гибридных систем с кусочно-линейной структурой в классах программных или позиционных управлений. 

}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\frame{ \frametitle{Список литературы}

\begin{thebibliography}{99}

\bibitem{ABK_hyb_sys} {\it Куржанский~А.Б., Варайя~П.} Задачи динамики и
управления в гибридных системах // Труды международного семинара
“Теория управления и теория обобщенных решений уравнений
Гамильтона-Якоби”. Екатеринбург: Изд-во Уральского университета,
2005. c.26--33.

\bibitem{ABK_upr_i_nabl} {\it Куржанский~А.Б.} Управление и наблюдение в
условиях неопределенности. М.: Наука, 1977.

\bibitem{solve_article} {\it Куржанский~А.Б., Точилин~П.А.} Слабо
инвариантные множества гибридных систем // Дифференциальные
уравнения. 2008. т.~44, N11.

\bibitem{Pshenichnyi} {\it Пшеничный~Б.Н.} Выпуклый анализ и
экстремальные задачи. М.: Наука, 1980.

\bibitem{Rokafellar} {\it Рокафеллар~Р.} Выпуклый анализ. М.: Мир, 1973.

% остальное не уместилось

%%
%%\bibitem{Branicky} {\it Branicky~M.S., Borkar~V.S., Mitter~S.M.} A
%%unified framework for hybrid control: model and optimal control
%%theory. // IEEE transactions on automatic control, 43/1 p.31--45,
%%1998.
%%
%%\bibitem{ABK_ellipse_for_reach_under_state_constraints} {\it
%%Kurzhanski~A.B., Varaiya~P.} Ellipsoidal techniques for
%%reachability under state constraints.// SIAM Journal on Control.
%%2003. V.45. N.4. p.1369--1394.
%%
%%\bibitem{ABK_internal_approx} {\it Kurzhanski~A.B., Varaiya~P.}
%%Ellipsoidal techniques for reachability analysis. Internal
%%approximation // System and Control Letters. 2000. V.41.
%%p.201--211.
%%
%%\bibitem{ABK_int_i_ext_approx} {\it Kurzhanski~A.B., Varaiya~P.}
%%Ellipsoidal techniques for reachability analysis. Part I: External
%%approximations. Part II: Internal approximations. Box-valued
%%constraints // Optimization methods and software. 2002. V.17.
%%p.177--237.
%%
%%\bibitem{Liberzon} {\it Liberzon~D.} Switching in systems and control. Boston: Birkh\"{a}user, 2003.
%%
%%\bibitem{Shumacher} {\it Van~der~Schaft~A., Schumacher~H.} An introduction to hybrid
%%dynamical systems. Lecture Notes in Control and Information
%%Sciences. N251. Springer, 2000.
 
\end{thebibliography}


}

\end{document}

