\section{Построение множества методами многозначного анализа.}

Перейдем к поиску решения задачи \eqref{eq:mainsystem} c помощью оценивания множеств методами многозначного анализа.

В отличие от первого подхода, где была найдена функция, полностью характеризующая решение сразу для двух систем уравнений и условия на переключение, теперь будем рассматривать каждый этап по отдельности.

\subsection{Множество достижимости  до переключения.}
\label{par_conv1}
Для системы дифференциальных уравнений 
\begin{equation}
\left\{
		    \begin{aligned}
		        &\dot x^{(1)} = A^{(1)}(t)x^{(1)}+B^{(1)}(t)u^{(1)}(t)+C^{(1)}(t)v^{(1)}(t);\\
		        &x(t_0)\in\mathcal{E}(x_0,X_0)=\mathcal{X}_0;\\
		        &u^{(1)}(t)\in\mathcal{E}(p^{(1)}(t),P^{(1)}(t))=\mathcal{P}^{(1)}[t_0,t_1];\\
						&v^{(1)}(t)\in\mathcal{E}(w^{(1)}(t),W^{(1)}(t))=\mathcal{V}^{(1)}[t_0,t_1];\\
		    \end{aligned}
\right.
\label{eq:mainsys_p1}
\end{equation}
требуется найти множество достижимости по \defref{def:XX1}. 

Это эквивалентно следующей задаче. Пусть нам даны  $\XX_0[t]$~--исходное множество, $\mathcal{P}(t)$~--множество допустимых управлений, $\mathcal C(t)$~-- множество помех, $X_0$, $\mathcal P(t)$, $\mathcal C(t)$~-- выпуклые компакты. Гарантированное множество достижимости находится как
$$
\XX[t]=\left(\XX_0[t]\dot-\mathcal C(t) \right) + \mathcal P(t).
$$
Здесь операция $\dot-$~--- \textit{геометрическая разность} (разность Минковского) двух компактных множеств.
\begin{define}
Геометрической разностью выражения $C=A\dot-B$ называется множество $C=\{c\mid c+B\subseteq A\}.$ {}
\end{define}

Решение задачи Коши для системы \eqref{eq:mainsys_p1}
$$
x(t)=G(t_0,t_1)x_0+\intd{t_0}{t_1}G(t_1,s)B(s)u(s)ds+\intd{t_0}{t_1}G(t_1,s)C(s)v(s)ds,
$$
где $x(t)$ -- траектория системы, определяется выбранным управлением $u(\cdot)$ и неизвестной реализацией помехи $v(\cdot)$.
Тогда гарантированная оценка множества достижимости имеет решение в виде
$$
\XX[t]=\left(G(t_0,t_1)\XX_0\dot-\intd{t_0}{t_1}G(t_1,s)\VV(s)ds\right)+\intd{t_0}{t_1}G(t_1,s)B(s)\PP(s)ds.
$$

Поскольку напрямую решать данные интегралы от множеств затруднительно, прибегнем к аппарату эллипсоидальных оценок \mycite{ABK_upr_i_nabl,ABK_internal_approx,ABK_int_i_ext_approx}. Мы можем оценить искомое множество  через внешние и внутренние эллипсоидальные оценки. Так что 
$$
\XX[t]\subseteq \bigcap_\ell\Ell(q^\ell_+(t),Q^\ell_+(t));
$$
$$
\XX[t]\supseteq \bigcup_\ell\Ell(q^\ell_-(t),Q^\ell_-(t)),
$$
где $\ell$ -- вектор, в направлении которого оценивающий эллипсоид касается искомого множества, $\Ell(q^ell_+(t),Q^\ell_+(t))$ -- внешняя эллипсоидальная оценка, $\Ell(q^\ell_-(t),Q^\ell_-(t)$ -- внутренняя эллипсоидальная оценка.
Поскольку ограничения на начальные условия, управление, помеху в задаче \eqref{eq:mainsys_p1} выражены эллипсоидами, выпуклыми компактами, то само $\XX[t]$~-- также будет выпуклым \mycite{ABK_int_i_ext_approx} и справедливо
$$
\bigcup_{\forall \ell}\Ell(q^\ell_-(t),Q^\ell_-(t))=\XX[t]=\bigcap_{\forall \ell}\Ell(q^\ell_+(t),Q^\ell_+(t)),
$$
где пересечение и объединение берутся по всем возможным направлениям  $\ell\in\rdim{n}$.

Параметры внутренней эллипсоидальной оценки $\Ell(q^\ell_-(t),Q^\ell_-(t))$ берутся из уравнения
\begin{equation}
\begin{gathered}\dot Q_-(t)=A(t)Q_-(t)+Q_-(t)A^T(t)+Q^{-\frach}_-(t)S(t)P^{\frach}(t)B(t)+B(t)P^{\frach}(t)B^T(t)S^T(t)Q^{\frach}_-(t)-\\
-\pi(t)Q_-(t)-\pi^{-1}(t)C(t)W(t)C^t(t),\\
\dot q_-(t)=A(t)q(t)+B(t)p(t)+C(t)w(t),
\end{gathered}
\end{equation}
где $S(t)$,$\pi(t)$ удовлетворяют соотношениям
$$
S(t)P^{\frach}(t)B^T(t)\ell(t)=Q^{\frach}_-(t)\ell(t)\lambda(t),
$$
$$
\pi(t)=\frac{ \ts{\ell(t),C(t)W(t)C^T(t)\ell(t)}^{\frach}} {\ts{\ell(t),Q_-(t)\ell(t)}^{\frach}},
$$
$$
\lambda(t)=\frac{ \ts{\ell(t),B(t)P(t)B^T(t)\ell(t)}^{\frach} }  { \ts{\ell(t),Q_-(t)\ell(t)}^{\frach} }, \quad\ell(t)=G^T(t,t_0)\ell_0,\;\ell_0\in\rdim{n}.
$$

Параметры внешней эллипсоидальной оценки $\Ell(q_+(t),Q_+(t))$ находятся из
\begin{equation}
\begin{gathered}
\dot Q_+=A(t)Q_-(t)+Q_-(t)A^T(t) + \pi(t)Q_+(t)+\pi^{-1}(t)B(t)P(t)B^T(t) - \\ -Q^{\frach}_+(t)S(t)W^{\frach}(t)C^T(t)-C(t)W^{\frach}(t)S^T(t)Q^{\frach}_+(t),
\end{gathered}
\end{equation}
где
$$
S(t)W^{\frach}(t)C^T(t)\ell(t)=\lambda(t)Q^{\frach}(t)\ell(t),
$$
$$
\pi=\frac{ \ts{\ell(t),B(t)P(t)B^T(t)\ell(t)}^{\frach}}  { \ts{\ell(t),Q_+(t)\ell(t)}^{\frach}},
$$
$$
\lambda(t)=\frac{\ts{\ell(t),C(t)W(t)C^T(t)\ell(t)}^{\frach}}  { \ts{\ell(t),Q_+(t)\ell(t)}^{\frach} },\quad\ell(t)=G^T(t,t_0)\ell_0,\;\ell_0\in\rdim{n}
$$

Итак, c помощью эллипсоидальных оценок мы можем вычислить сколь угодно точную оценку множества достижимости $\XX^{(1)}[t,t_0,\XX_0]$ (по Опр.\ref{def:XX1}) для любого момента времени $t$ и начального условия $\XX_0$.

Необходимо отметить, что $\XX[t,t_0]$ образовано композицией двух множеств. Первое,   
$$\left(G(t_0,t_1)\XX_0\dot-\intd{t_0}{t_1}G(t_1,s)\VV(s)\right)$$
 --~образующее, обеспечивает множество гарантированного попадания, а другое, 
$$\intd{t_0}{t_1}G(t_1,s)B(s)\PP(s)$$
 --~границы управляемого смещения первого множества.
Кроме того, может оказаться, что начиная с некоторого $\tau>t$, $\XX[t,t_0]$  окажется пустым, если $\left(\XX_0[t]\dot-\mathcal C(t) \right)$ выродится. Соответственно, расчет для второй системы необходимо выполнять не c   множеством $$\XX^{(1)}[t,t_0,\XX_0]\cap H(c,\gamma),$$ а с пересечением образующего множества $$\left(G(t_0,t_1)\XX_0\dot-\intd{t_0}{t_1}G(t_1,s)\VV(s)ds+\phi^\alpha\right)\cap H(c,\gamma),$$
где 
$$\phi^\alpha=\intd{t_0}{t_1}G(t_1,s)B(s)u^\alpha(s)ds,\quad u^\alpha(\cdot)\in\PP(\cdot).$$
Поэтому, в дальнейшем мы будем искать множество достижимости второй системы для фиксированного $p^\alpha(\cdot)$.



\subsection{Пересечение с гиперплоскостью.}
\newcommand{\CaH}{C^\alpha_H}
\newcommand{\phia}{\phi^\alpha}
\newcommand{\TTa}{\mathcal{T}^\alpha}
Рассмотрим теперь вычисление множеств, образованных пересечением множества достижимости первой системы с гиперплоскостью $H(c,\gamma)=\{x\mid \ts{x,c}=\gamma\}$. 
Пусть 
$$
\begin{gathered}
C(s)\defeq\left(G(t_0,t_1)\XX_0\dot-\intd{t_0}{t_1}G(t_1,s)\VV(s)ds\right),\\
\phia(t)\defeq\intd{t_0}{t}G(t_1,s)B(s)u^\alpha(s)ds,\\
\CaH(s)\defeq\left(C(s)+\phia(s)\right)\cap H\\
\TTa\defeq\{\tau\mid \CaH[\tau]\neq\emptyset\}=[\tau^\alpha_1,\tau^\alpha_2]
\end{gathered}
$$
Мы предполагаем выполненным условие односторонней проницаемости \eqref{eq:transv2} или , поэтому можем утверждать, что множество $\CaH(\TTa)$ -- односвязное.
В случае невыполнения условий трансверсальности (односторонней проницаемости), множество $\CaH(\TTa)$ может быть несвязным, в этом случае дальнейший анализ существенно затруднится \epicref{pic:transv}. 
$$
\left\{
\begin{aligned}
			&\ts{x(\tau),c} - \gamma = 0,\\
			&\ts{x(\tau+\epsilon),c}-\gamma > 0,\quad\forall \epsilon>0.\\			
\end{aligned}
\label{eq:transv2}
\right.
$$

\labtwinimage{transv1}{transv2}{8}{Выполнение и невыполнение условий трансверсальности.}{pic:transv}

В пункте \ref{par_conv1} мы нашли оценку множества достижимости с помощью эллипсоидальных оценок.
Вычислим теперь $\CaH[\tau]$

\begin{propose}[\mycite{ABK_hyb_sys}] Пусть эллипсоид 
$$
\mathcal{E}(q,Q)=\{x\mid \ts{x-q,Q^{-1}(x-q)\leqslant 1}
$$ и гиперплоскость 
$$
H=\{x\in\mathbb{R}^n:\;\langle x,c\rangle=\gamma\}
$$ таковы, что
$\mathcal{E}(q,Q)\cap\mathcal{H}(c,\gamma)\neq \emptyset$. Тогда $\mathcal{E}(q,Q)\cap\mathcal{H} = \mathcal{E}(\tilde{q},\tilde{Q})$ - вырожденный эллипсоид
(т.е. $\tilde{Q}=\tilde{Q}^T\geqslant0,\;det(\tilde{Q})=0$).
\end{propose}
{\it Доказательство.} Пусть $T\in\mathbb{R}^{n\times n}$ - такая невырожденная матрица, что $Tc=e_1$, где $e_1=(1,0,\ldots,0)$. Используя замену переменных
$x=T'y$ и $q=T'p$, преобразуем множество $\mathcal{E}(q,Q)\cap\mathcal{H}$:

$$
\begin{aligned}
\mathcal{E}(q,Q)\cap\mathcal{H}&=\{x\in\mathbb{R}^n:\langle x-q,Q^{-1}(x-q)\rangle \leqslant1,\langle x,c \rangle=\gamma\}=\\
&T'\{y=(\gamma,z)',z\in\mathbb{R}^{n-1}:\langle z-\tilde{q},\tilde{Q}(z-\tilde{q})\rangle \leqslant 1\}
\end{aligned}
$$
$$
TQ^{-1}T'=\left(\begin{array}{ccc} a & c' \\ c & D \end{array} \right),\;D\in\mathbb{R}^{(n-1)\times(n-1)},p=\left(\begin{array}{ccc} p_1 \\ \tilde{p} \end{array}\right),\tilde{p}\in\mathbb{R}^{n-1}
$$
$$
\tilde{q}=\tilde{p}-D^{-1}(\gamma-p_1)c\;,\;A=\frac{D}{1-(\gamma-p_1)^2(a-\langle c,\;D^{-1}c\rangle)}
$$
И проверкой подстановки
$$
\tilde{q}=T'\left(\begin{array}{ccc} \gamma \\ \tilde{q} \end{array} \right),\tilde{Q}=T'\left(\begin{array}{ccc} 0 & 0\\ 0 & A^{-1} \end{array} \right)T
$$
завершаем доказательство утверждения. $\square$

Нам важно найти не столько вырожденный эллипсоид $\Ell(\tilde q,\tilde Q)$, сколько его пересечение с гиперплоскостью.
Легко видеть, что это будет эллипсоид с размерностью на единицу меньше, его параметры находятся как $q_H=\gamma D^{-1}c$, $Q_H=A^{-1}$. Вектор $q_H$ указывает смещение эллипсоида относительно опущенного на плоскость перпендикуляра, выпущенного из центра пересекаемого эллипсоида \epicref{pic:ellips_ints_H}.

\labimage{ellips_ints_H2D}{7}{Пересечение эллипсоида с плоскостью.}{pic:ellips_ints_H}

Таким образом, для момента времени $\tau\in\TTa$ мы получили семейство эллипсоидов размерности на единицу меньше, расположенные на плоскости $H$, которые, в свою очередь оценивают искомое сечение множества пересечения, которое остается выпуклым. Это семейство внутренних и внешних оценок также можно оценивать новыми оценками, с целью уменьшения дальнейших вычислений.

\subsection{Вычисление множества достижимости для второй системы}

На данном этапе у нас имеется семейство $(\TTa,\CaH(\TTa))$, которое является начальным условием для задачи 
\labform{
	\left\{
	    \begin{aligned}
	        &\dot x^{(2)} = A^{(2)}(t)x^{(2)}+B^{(2)}(t)u^{(2)}(t)+C^{(2)}(t)v^{(2)}(t);\\
	        &x(\tau)\in\CaH[\tau],\;\tau\in\TTa\\
	        &u^{(2)}(t)\in\mathcal{E}(p^{(2)}(t),P^{(2)}(t))=\mathcal{P}^{(2)}[t_0,t_1];\\
					&v^{(2)}(t)\in\mathcal{E}(w^{(2)}(t),W^{(2)}(t))=\mathcal{V}^{(2)}[t_0,t_1];\\
	    \end{aligned}
	\right.
}{eq:mainsys_p2}

Мы не можем построить множество достижимости так же как и для первой системы, поскольку здесь начальные условия ''распределены'' во времени, и соответственно это надо учитывать, что отличает эту задачу от предыдущей. Здесь можно воспользоваться методами решения задач с фазовыми ограничениями \cite{ABK_ellipse_for_reach_under_state_constraints}, но в отличие от них нам требуется учитывать неопределённость. Гарантированная оценка множества достижимости $\XX^\alpha_2[t,t_0]$ для \eqref{eq:mainsys_p2} описывается как
\labform{
\begin{gathered}
\XX^\alpha_2[t_1]=\{x_2\mid \exists u_2(\cdot)\in \PP^{(2)}[t_0,t_1]: \forall v_2(\cdot)\in \VV^{(2)}[t_0,t_1]: \\ 
\exists \tau\in\TTa,x_h(\tau)\in\CaH[\tau]: x(t,\tau,x_h(\tau),u_2(\cdot),v_2(\cdot))=x_2\}
\end{gathered}
}{eq:attain_set_2}
Найдем множество точек $\QQ[\tau]$ в момент времени $\tau$, из которых мы можем прийти в точку $x_2=0$ в конечным момент $t_1$ при отсутствии управления. 

$$
\QQ[\tau] = \intd{t_1}{\tau}G(\tau,s)C_2(s)\VV_2(s)ds,
$$ 
где $$G(\tau,t)=\exp{\left(\intd{\tau}{t}A_2(s)ds\right)}.$$
Согласно \eref{eq:attain_set_2} 
\labform{\forall \tau\in \TTa: (\xi(\tau)+\QQ[\tau])\cap H \subseteq \CaH[\tau],\quad \mbox{где}
}{eq:bounds}  $$ \xi(\tau)= G(\tau,t_1)x_2+\intd{t_1}{\tau}G(\tau,t_1)u_2(s)ds.$$
Найдем множество фазовых ограничений
$$
Z[\tau]=\{\xi(\tau)\mid (\xi(\tau)+\QQ[\tau])\cap H \subseteq \CaH\}
$$
Для любого $\xi(\tau)\in Z[\tau]$  выполнено \eref{eq:bounds}. 
Используя свойство выпуклости и симметрии множества $\QQ[\tau]$, находим $Z[\tau]$ как 
дополнение ко множеству всех точек $\tilde{\xi}(\tau)$, в которых $(\tilde{\xi}(\tau)+\QQ[\tau])$ касается $(H\setminus \CaH[\tau])$ или 
$$
Z[\tau]=\overline{ H\setminus \CaH[\tau] + \QQ[\tau]},
$$
что проиллюстрировано на \picref{bset_xi}.
\labimage{bset_xi_H}{10}{Множество фазовых ограничений}{bset_xi}
Легко видеть, что оно строиться как дополнение к некоторому семейству выпуклых множеств, и в данном случае для любых $\QQ[\tau]$, $\CaH[\tau]$  не может быть выпуклым, что является ограничением для вычисления множества достижимости c учетом фазовых ограничений $Z[\tau]$. Поэтому, будем решать задачу поиска множества достижимости при условии огибания препятствия $\overline{Z[\tau]}$. Поскольку множество $\overline{Z[\tau]}$ состоит из множества эллипсоидов (эллипсоидальные оценки множества $\QQ[\tau]$), выделим среди них те, которые непосредственно примыкают к $Z[\tau]$, тогда мы можем обойти только считанные из них (для момента $\tau$ ), и попасть на целевое множество $\XX^\alpha_2[t_1]$, Центры всех примыкающих эллипсоидов  расположены на границе $\CaH[\tau]$. Если мы решаем задачу в $\rdim{1}$, то множество $\CaH[\tau]$- это точка, множество примыкающих эллипсоидов состоит из отрезка с центром в этой точке. Для задачи в $\rdim{2}$, $\CaH[\tau]$~-- отрезок, концы которого служат центрами для выбранных эллипсоидальных оценок $\QQ[\tau]$, см. \picref{bset_xi}.
Для $\rdim{n}, n\ge3$, множество $\CaH[\tau]$ образует замкнутую линию ($n=3$), или поверхность ($n>3$), так что задача существенно усложняется. 

Итак мы нашли условия на фазовые ограничения для траекторий $\xi(\tau)$, таких, что выполняется \eqref{eq:bounds}. Из условий \eqref{eq:attain_set_2} и трансверсальности \eqref{eq:perehod} мы обнаруживаем, что, для того, чтобы траектория $\xi(\cdot)$ принадлежала множеству $\XX_2[t_1]$ достаточно, чтобы она входила во множество $Z[\tau_1]$, в любой из моментов $\tau_1\in\TTa$, и покидало множество $Z[\tau_2]$ в любой момент $\tau_2\in \TTa, \tau_2>\tau_1$.
Можно обозначить множество $X^{(2)}_0[\tau^\alpha_1]=\{x\mid x \le H+\QQ[\tau^\alpha_1]$ как начальное множество в момент $\tau^\alpha_1$ для задачи поиска множества достижимости с фазовыми ограничениями на огибание препятствия.
Поскольку данное множество  $X^{(2)}_0$~-- задаёт полупространство, а мы хотим эллипсоидальную оценку, можно выбрать достаточно большой эллипсоид, который позволит нам для любого момента $\tau\in\TTa$ полностью покрывать траекториями нижнюю границу (lower boundary на \picref{bset_xi}), двигаясь согласно правилу односторонней проницаемости.  

Пусть имеется некоторый эллипсоид $\ELL{q(t),Y(t)}$, который мы будем огибать, стартуя из множества $\XX_0$.
Уравнение на траекторию имеет вид $\dot x=A(t)x(t)+u(t), x\in\rdim{n}$.
Не умаляя общности, мы можем положить $q(t)\equiv 0$. Пусть 
$$
L^0(t)=\left\{\lambda^0(t)=\dfrac{Y^{-1}(t)z}{\ts{z,Y^{-1}z}^\frach}\mid \forall z:\ts{z,Y^{-1}z}=1 \right\}.
$$
Тогда $x(t)\notin\Ell(0,Y(t)) \Leftrightarrow \exists \lambda^0: \ts{\lambda^0,x(t)}\ge 1$.
Имеем начальные ограничения на множество $\XX_0$ и и фазовые ограничения на $x(s)$
$$
\forall \ell: \ts{\ell,x_0} \le \supfnl{X_0},
$$
$$
  -( \ts{\lambda(s),x(s)} -1 ) \le 0.
$$
Введем множитель Лагранжа $\Lambda(\cdot) \in BV(t_0,t_1)$ во втором условии и сложим выражения,  получим
$$
\ell^TG(t_0,t_1)x_1-\intd{t_0}{t_1}\ts{\ell,G(t_0,s)u(s)ds} - 
$$
$$
  - \Big( \intd{t_0}{t_1}\lambda^T(s)G(t_0,t_1)x_1d\Lambda - \intd{t_0}{t_1}ds G^T(t_0,s)u(s)\intd{t_0}{s}\lambda(\xi)d\Lambda - \intd{t_0}{t_1}d\Lambda \Big) \le \supfnl{X_0}
$$
Сгруппируем слагаемые
$$
 \Big( G^T(t_0,t_1)\ell - \intd{t_0}{t_1}G^T(s,t_1)\lambda(s)d\Lambda(s) \Big)^Tx_1-\intd{t_0}{t_1} u^T(\xi) \Big(G^T(\xi,s)\ell-\intd{t_0}{s}G^T(\xi,s)\lambda(s)d\Lambda(\xi)\Big)ds+
$$
$$
+\intd{t_0}{t_1}d\Lambda -  \supfnl{\XX_0}\le 0
$$
Обозначим $$p(s)=G^T(t_0,s)\ell-\intd{t_0}{s}G^T(\xi,s)\lambda(\xi)d\Lambda(\xi),$$ и потребуем $\intd{t_0}{t_1}d\Lambda=1,$ тогда получим 
$$
p^T(t_1)x_1-\intd{t_0}{t_1}p(s)u(s)ds-\supfn{s(t_0)}{\XX_0}+1\le 0,\quad \forall \ell, \lambda(\cdot)\in L^0(\cdot).
$$
Запишем функцию цены, как в первой части данной работы.
$$
V(t,x)=\max_{\lambda(\cdot)\in L^0} \min_{u(\cdot)}\max_{\ell,\Lambda(\cdot)}\big\{p^T(t_1)x_1-\intd{t_0}{t_1}p(s)u(s)ds-\supfn{s(t_0)}{\XX_0}+1\big\}
$$
Предполагаем, что $\max_{\ell,\Lambda(\cdot)}$ достигается. Выражение под $\max$~-- вогнуто по $\ell,\Lambda$. Пользуясь теоремой о минимаксе \cite{Rokafellar}, придем к
$$
V(t,x)=\max_{\lambda(\cdot)\in L^0}\max_{\ell,\Lambda(\cdot)}\big\{p^T(t_1)x_1-\intd{t_0}{t_1}\supfn{p(s)}{\PP(s)}ds-\supfn{s(t_0)}{\XX_0}+1\big\}
$$

И тогда множество достижимости находится как множество уровней
$$
\XX^\alpha_2[t_1]=\{x_2\mid V(t_1,x_2)\leqslant 0\}
$$

Индекс $\alpha$ здесь указывает на то, что данное множество мы находили при фиксированном $u^\alpha_1(s)\in\PP^{(1)}[t_0,t_1]$.
Тогда полное множество достижимости найдется как 
$$
\XX_2[t_1,t_0,\XX_0]=\bigcup_{\alpha}\XX^\alpha_2[t_1,\tau^\alpha_1]
$$

\subsection{Пример}
Рассматривается модель гибридной системы, состоящей из двух связанных линейных дифференциальных уравнений c условием переключения
\begin{equation}
\label{eq:prim1a}
\left\{
\begin{aligned}
	&\left[
		\begin{aligned}
				&\dot x_1=u_1+v_1; \\
				&\dot x_2=u_2+v_2;
		\end{aligned}
	 \right.\\
	&u_1(t)\in[0.4\cos(\pi\cdot t),1.5+0.6\sin(\pi\cdot t)]=\PP^{(1)};\\
	&v_1(t)\in[0,0.2+0.1\sin(\pi\cdot t)]=\QQ^{(1)};\\
	&u_2(t)\in[0.3+\sin^2(\pi\cdot t),0.5\cos^2(\pi\cdot t)]=\PP^{(2)};\\
	&v_2(t)\in[-0.1\sqrt{t},0.1\sqrt{t}]=\QQ^{(2)};\\
	&\mathcal{X}_0=[-2,-1],\;x(t)\in\rdim{1}\\
	&t\in[0,4];\\
	&H=\{x=0\}.
\end{aligned}
\right.
\end{equation}

Для данной модели рассчитано множество достижимости для набора управлений, равномерно покрывающего множество управлений $\PP_1$, что обеспечивает достаточно близкую оценку множества $\XX_2[t_1,t_0,\XX_0]$. На иллюстрации \epicref{notsimplex2} отмечены множества $\XX^{\alpha_1}[t,t_0,\XX_0]$,{} $\XX^{\alpha_2}[t,t_0,\XX_0]$, которым соответствуют управления $u^{\alpha_1}_1,\;u^{\alpha_2}_1$, показаны их пересечения с гиперплоскостью $\XX^{\alpha_1}[t,t_0,\XX_0]\cap H$, $\XX^{\alpha_2}[t,t_0,\XX_0]\cap H$, на основе которых построено множество $\XX_2[t_1,t_0]$.

\labimage{notsimplex2}{13}{Множество достижимости гибридной системы \eqref{eq:prim1a}.}{notsimplex2}
Круглыми маркерами помечены границы вложения множества неопределенности в множество начальных условий $\CaH$. Темными линиями обозначены верхние границы подмножеств $\XX_2$, светлыми линиями -- нижние границы.

\newpage 
Также построен пример \epicref{x2simple}, иллюстрирующий, как множество помех (штриховка) должно вкладываться в множество $\XX^{(2)}_1\cap H$, чтобы иметь гарантированную оценку в конечный момент $t_1$, показано другое множество $\XX^{(1)}_1\cap H$, которое уже не может вместить множество помех, и, соответственно, не имеет гарантированной оценки в конечный момент времени $t_1$.

\labimage{x2simple}{13}{Множество достижимости для двух выбранных управлений, вложение множества помех (штриховка).}{x2simple}
  